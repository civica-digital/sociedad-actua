- content_for :landing do
  #video.content-video
    = video_tag 'https://s3.amazonaws.com/sociedad-actua-production/SA-C.mp4',
    class: 'video', width: '100%', autoplay: true, muted: true, loop: true
    .content__overlay
      %h1.content__heading Sociedad Actúa
      %p.content__desc
        es el lugar de encuentro entre organizaciones, proyectos, inversionistas y personas

#explore.row.text-center
  %h1 Descubre

  .col-xs-12.col-sm-3.text-center
    = link_to projects_list_path do
      = image_tag 'roles/projects_2x.png', class: 'landing-icon'
      %h3 Proyectos
    %p Acciones que están realizando individuos, grupos o instituciones para mejorar nuestra sociedad

  .col-xs-12.col-sm-3.text-center
    = link_to organizations_path do
      = image_tag 'roles/organizations_2x.png', class: 'landing-icon'
      %h3 Organizaciones
    %p Organizaciones legalmente constituidas que ejecutan proyectos

  .col-xs-12.col-sm-3.text-center
    = link_to organizations_path do
      = image_tag 'roles/groups_2x.png', class: 'landing-icon'
      %h3 Grupos
    %p Colectivos sin figura jurídica que ejecutan proyectos

  .col-xs-12.col-sm-3.text-center
    = link_to investors_path do
      = image_tag 'roles/investors_2x.png', class: 'landing-icon'
      %h3 Inversionistas
    %p Organizaciones y personas interesadas en invertir en los proyectos sociales

.row
  .col-md-12.map-landing{:id=>"map"}
    = simple_form_for :tag, :url => root_path(:anchor => "map", :defaults => {:required => false}), :method => :get do |f|
      .row
        .col-md-1
          = image_tag "landing/encuentra_2x.png", class: "img-responsive"
        .col-md-11.padding-text-map
          .row
            .col-md-6
              %p.big-ass.bright Encuentra
              %p.bright Encuentra proyectos por ubicación geográfica
            .col-md-6.text.right
              =f.input :name, collection: @projects, include_black: false,input_html: { "data-placeholder"=> I18n.t('simple_form.placeholders.search'), class: "chosen-select ", tabindex: "2", :onchange=>"show_marker();"}, :label =>false, :required => false


      =f.label I18n.t('simple_form.placeholders.fields'), class: "yellow", :required => false
      .yellow.glyphicon.glyphicon-chevron-down{:data => {:toggle => 'collapse', :target => '.avanzada'}}
      .row.avanzada.panel-collapse.collapse{"aria-labelledby" => "headingOne", :role => "tabpanel"}
        .col-md-1
        .col-md-3
          =f.label I18n.t('simple_form.placeholders.search_city'), class: "bright", :required => false
          =f.input :city, collection: CITIES, include_black: false,input_html: { "data-placeholder"=> I18n.t('simple_form.placeholders.organization.city'), class: "chosen-select", tabindex: "2"  }, label: false, :required => false
        .col-md-2
          =f.label I18n.t('simple_form.placeholders.search_ageb'), class: "bright", :required => false
          =f.input :ageb, :label =>false, :required => false
        .col-md-2
          =f.label I18n.t('simple_form.placeholders.search_distrito'), class: "bright", :required => false
          =f.input :distrito, :label =>false , :required => false
        .col-md-2
          =f.label I18n.t('simple_form.placeholders.search_seccion'), class: "bright", :required => false
          =f.input :seccion, :label =>false , :required => false
        .col-md-1.margin-top-button.text-right
          = f.button :submit, "buscar"
    %div{:id=>"geolocation", :style=>'width: 100%; height: 400px;'}
    .row
      .col-md-2.padding-text-map
        = link_to "ver listado", projects_list_path, :class=>"btn btn-default"
      .col-md-10.text-right.padding-text-map
        = link_to "descargar proyectos", download_csv_project_visitors_path(format: :csv),:class=>"btn btn-default"

- if @organizations.count >= 4
  #showcase.row
    %h3.fourth_accent
      = image_tag 'other/showcase_2x.png', class: 'icon-title'
      Descubre
    %h5.fourth_accent Descubre lo que está pasando en el lugar donde vives
    .showcase
      = render "showcase", organizations: @organizations.take(2), type: :even
      = render "showcase", organizations: [@organizations.third, @organizations.fourth], type: :odd


:javascript
  $(document).ready(loadMapLanding);
  var markersArray = [];
  //mostramos en el mapa la ubicacion del usuario
    function centerOnMap(position){
      var array_lat =  "#{raw @array_lat}".substring(1,"#{raw @array_lat}".length-1).split(",");
      var array_lng = "#{raw @array_lng}".substring(1, "#{raw @array_lng}".length-1).split(",");
      var array_name = '#{raw @array_name}'.substring(1, '#{raw @array_name}'.length-1).split(",");
      var array_url = '#{raw @array_url}'.substring(1, '#{raw @array_url}'.length-1).split(",");
      for(i=0; i< array_lng.length; i++){
       marker = handler.addMarker({
          lat: array_lat[i],
          lng: array_lng[i],
          infowindow: "<a href=" + array_url[i] + ">Proyecto: " + array_name[i] + "</a>",
          title:  array_name[i]
        });
        markersArray.push(marker);
      }
      if(array_lat[0]+"" == ""){
        handler.map.centerOn(["25.6754382","-100.3483728"]);
      }else{
        handler.map.centerOn([array_lat[array_lat.length-1],array_lng[array_lng.length-1]]);
      }

      handler.getMap().setZoom(10);
  }
